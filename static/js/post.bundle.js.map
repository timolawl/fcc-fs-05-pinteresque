{"version":3,"sources":["../../../node_modules/browser-pack/_prelude.js","post.js"],"names":["e","t","n","r","s","o","u","a","require","i","f","Error","code","l","exports","call","length","1","module","checkForm","path","validateInput","pw","pwConfirm","submitBtn","disabled","Array","from","inputs","every","input","value","match","getAttribute","form","querySelector","style","outline","document","getElementsByClassName","onkeyup","onclick","playSplashPageAnimation","index","words","el","classList","remove","add","setTimeout","lastChild","addEventListener","handleEvent","contains","removeEventListener","propertyName","displayPreview","data","source","createBook","socket","emit","bookObject","requestSection","currentStep","json","title","items","volumeInfo","author","authors","description","thumbnail","checkProperty","link","canonicalVolumeLink","industryIdentifiers","forEach","id","type","ISBN_10","identifier","ISBN_13","console","log","textContent","parseAuthorArray","src","elements","_id","href","displayBook","book","queryEvent","fragment","DocumentFragment","newImg","createElement","newDiv","setAttribute","appendChild","transactionLock","newImg2","bookId","prependChild","renderQuery","requestStep","bookshelfQuery","bookshelfComplete","wrapperQuery","hasChildNodes","removeChild","query","books","authorsArray","arrClone","isArray","prototype","slice","authorsLength","join","object","pathToKey","keyDepth","split","currentKey","hasOwnProperty","parent","newFirstChild","insertBefore","firstChild","populateTransactions","booksIWantFragment","booksOthersWantFragment","requestTransactions","displayTransaction","_i","offerTransactions","transaction","transactionType","newTradeDiv","createTradeDiv","oBook","rBook","tradeBtns","tradeBtnApprove","tradeBtnDecline","option","parentNode","tradeDiv","descDiv","pictoDiv","bookSelfOwnedDiv","bookSelfOwnedImg","arrowDiv","arrowImg","bookOtherOwnedDiv","bookOtherOwnedImg","io","window","onload","location","pathname","room","toLowerCase","reset","on","querySelectorAll","book1","book2","preventDefault","userInput","search","replace","selectOption","queryURL","encodedURL","encodeURI","fetchHeaders","method","headers","accept","fetch","then","res","totalItems","request"],"mappings":"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","file":"post.bundle.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","'use strict';\n\n// socket io -- the cdnjs script is in the HTML template above this script file\nconst host = 'timolawl-bookclub.herokuapp.com';\nvar socket = io();\n/*\nif (host == location.host) {\n  socket = io.connect('https://timolawl-voting.herokuapp.com:5000');\n}\nelse socket = io.connect('//localhost:5000');\n*/\n\nfunction checkForm (path) {\n    // on form change or on group of input change, test\n    const form = document.querySelector('form');\n    // need live nodelist since add/deleting:\n    const inputs = document.getElementsByClassName('form__input');\n    const submitBtn = document.querySelector('input[type=\"submit\"]');\n    submitBtn.disabled = true;\n\n    function validateInput () {\n        let unique, pw, pwConfirm;\n\n        submitBtn.disabled = true;\n\n        if (Array.from(inputs).every(input => input.value.match(input.getAttribute('pattern')))) {\n          if (path === 'signup') {\n            pw = form.querySelector('.form__input--password');\n            pwConfirm = form.querySelector('.form__input--confirm');\n            if (pw.value === pwConfirm.value) {\n              pw.style.outline = 'initial';\n              pwConfirm.style.outline = 'initial';\n              submitBtn.disabled = false;\n            }\n            else {\n              pw.style.outline = '1px solid red';\n              pwConfirm.style.outline = '1px solid red';\n            }\n          }\n          else submitBtn.disabled = false;\n        }\n    }\n    form.onkeyup = validateInput;\n    form.onclick = validateInput;\n}\n\nwindow.onload = function () {\n  // socket io logic:\n  if (location.pathname.match(/^\\/$/)) // if home path\n    socket.emit('change room', { room: location.pathname }); // '/'\n\n  else socket.emit('change room', { room: location.pathname.toLowerCase().slice(1) });\n\n  /*\n  if (location.pathname.match(/^\\/(?:allbookshelves|mybookshelf)\\/?$/i))\n    socket.emit('change room', { room: location.pathname.toLowerCase().slice(1) });\n\n  if (location.pathname.match(/^\\/(?:signup|login|settings|allbookshelves|mybookshelf)\\/?/i))\n    socket.emit('leave room', { path: location.pathname.toLowerCase().slice(1) });\n    */\n\n  \n\n/****************/    \n\n  if (location.pathname.match(/^\\/$/)) {\n    setTimeout(() => { playSplashPageAnimation(0) }, 1500); // start from the first index of 0.\n  }\n\n  if (location.pathname.match(/^\\/(?:signup|login)\\/?$/i)) {\n    // clear out form\n    document.querySelector('form').reset();\n    // gray out submit button until everything is filled in.\n    checkForm(location.pathname.toLowerCase().slice(1));\n  }\n\n  if (location.pathname.match(/^\\/allbookshelves\\/?$/i)) {\n\n  //  socket = io('/allbookshelves'); // change socket name space\n\n    socket.on('CREATE.book.render', data => {\n      // add book to the front of the book list\n      displayBook(data.book, false);\n\n    });\n\n    socket.on('READ.book.render', data => {\n      displayPreview(data.book, 'internal-query');\n    });\n\n    socket.emit('READ.bookshelves.all', {});\n\n    \n    socket.on('READ.bookshelves.all.render', data => {\n      // display all books in order:\n      for (let i = 0; i < data.books.length; i++) {\n        displayBook(data.books[i], false);\n      }\n    });\n\n    // from tranaction updates\n    socket.on('UPDATE.books.render', data => {\n      Array.prototype.forEach.call(document.querySelectorAll('.book'), book => {\n        let bookId = book.getAttribute('data-id');\n        if (bookId === data.book1 || bookId === data.book2 ) {\n          book.removeChild(book.querySelector('book__lock'));\n        }\n      });\n    });\n\n    // socket.emit -> READ.bookshelf.query\n    document.querySelector('form').addEventListener('submit', e => {\n      e.preventDefault();\n      let userInput = document.querySelector('.search__bar__input--allbookshelves').value;\n        socket.emit('READ.bookshelves.query', { search: userInput.replace(/\\$/g, '') });\n    });\n\n    // allow pressing enter to trigger submit as well when input is selected\n    //document.querySelector('.search__bar__input--allowbookshelves').addEventListener(\n\n    socket.on('READ.bookshelves.query.render', data => {\n      renderQuery(data);\n    });\n\n    /*\n    socket.on('CREATE.transaction.render', data => {\n    });\n    */\n\n  }\n\n/************************************************************/\n\n  if (location.pathname.match(/^\\/mybookshelf\\/?$/i)) {\n\n  //  socket = io('/mybookshelf');\n\n    socket.on('CREATE.book.render', data => {\n      displayBook(data.book, false);\n    });\n\n    socket.on('READ.book.render', data => {\n      displayPreview(data.book, 'internal-query');\n    });\n\n    socket.emit('READ.bookshelf.all', {});    \n\n    socket.on('READ.bookshelf.all.render', data => {\n      for (let i = 0; i < data.books.length; i++) {\n        displayBook(data.books[i], false);\n      }\n    });\n\n\n    // from transaction updates\n    socket.on('UPDATE.books.render', data => {\n      Array.prototype.forEach.call(document.querySelectorAll('.book'), book => {\n        let bookId = book.getAttribute('data-id');\n        if (bookId === data.book1 || bookId === data.book2 ) {\n          book.removeChild(book.querySelector('book__lock'));\n        }\n      });\n    });\n\n\n    // add -> CREATE.book\n    // find -> READ.bookshelf.query\n    document.querySelector('form').addEventListener('submit', e => {\n      e.preventDefault();\n      // check the select option first\n      let selectOption = document.querySelector('.search__bar__option').value;\n      let userInput = document.querySelector('.search__bar__input--mybookshelf').value;\n      \n      if (selectOption === 'add') {\n        // search using google API\n        // sanitize input, then ajax -> to populate the preview section?\n        let queryURL = 'https://www.googleapis.com/books/v1/volumes?q=' + userInput;\n        let encodedURL = encodeURI(queryURL);\n        let fetchHeaders = { method: 'GET', headers: { accept: 'application/json' } };\n        fetch(encodedURL, fetchHeaders)\n          .then(res => res.json())\n          .then(json => {\n            if (json.totalItems) // if there are items.\n              displayPreview(json, 'external-query');\n            else console.log('There are no books found with the given search criteria.');\n          })          \n      }\n      else if (selectOption === 'find') {\n        // search current bookshelf/bookshelves for the book in question via permalink?\n        // to use good search, can go through google api again, but that requires keeping the\n        // google generated book id (permalink?)\n        // otherwise, the search has to be perfect by title or author\n        // (isn't this always the case though?)\n        // should this search go through the db for integrity? going through\n        // client side only doesn't really work for large libraries.\n        // is this where socket is used?\n\n        // replace all instances of the dollar sign to prevent NoSQL injection attack\n        socket.emit('READ.bookshelf.query', { search: userInput.replace(/\\$/g, '') });\n      }\n    });\n\n    socket.on('READ.bookshelf.query.render', data => {\n      renderQuery(data);\n    });\n\n\n    /*\n    socket.on('CREATE.transaction.render', data => {\n    });\n    */\n\n  }\n\n/********************************************/\n\n  if (location.pathname.match(/^\\/request\\/?$/i)) {\n\n   // socket = io('/request');\n\n    socket.on('READ.book.render', data => {\n      displayPreview(data.book, 'internal-request');\n    });\n\n\n    // Step 1: query bookshelves\n    // socket.emit -> READ.bookshelves.query\n    document.querySelector('.request__section--one form').addEventListener('submit', e => {\n      e.preventDefault();\n      let userInput = document.querySelector('.request__section--one .search__bar__input').value;\n      socket.emit('READ.bookshelves.query', { search: userInput.replace(/\\$/g, ''), request: true }); // specify that it is from the request path, and thus will not display own books\n    });\n\n    socket.on('READ.bookshelves.query.render', data => {\n      renderQuery(data, 'step-one');\n    });\n\n    // Step 2: query bookshelf\n    document.querySelector('.request__section--two form').addEventListener('submit', e => {\n      e.preventDefault();\n      let userInput = document.querySelector('.request__section--two .search__bar__input').value;\n      socket.emit('READ.bookshelf.query', { search: userInput.replace(/\\$/g, ''), request: true });\n    });\n\n    socket.on('READ.bookshelf.query.render', data => {\n      renderQuery(data, 'step-two');\n    });\n\n    // Step 3: confirm step\n    //\n    /*\n    socket.on('CREATE.transaction.render', data => {\n    });\n    */\n\n  \n\n\n  }\n\n/********************************************/\n  \n  if (location.pathname.match(/^\\/pending\\/?$/i)) {\n    socket.emit('READ.transactions.pending', {});\n\n    socket.on('READ.transactions.pending.render', data => {\n      populateTransactions(data, 'pending');\n    });\n\n    /*\n    socket.on('CREATE.transaction.render', data => {\n    });\n    */\n\n\n    // from transaction updates\n    socket.on('UPDATE.transactions.render', data => {\n      let query = `'[data-id=\"${data.transaction}\"]'`;\n      if(document.querySelector(query)) {\n        document.querySelector(query).parentNode.removeChild(document.querySelector(query));\n      }\n    });\n\n\n\n    \n    \n    // when others request a book from user or when user requests a book on a different tab\n    //socket.on('UPDATE.transactions.render'\n  }\n\n\n  if (location.pathname.match(/^\\/completed\\/?$/i)) {\n    socket.emit('READ.transactions.complete', {});\n\n    socket.on('READ.transactions.complete.render', data => {\n      populateTransactions(data, 'completed');\n    });\n\n    /*\n    socket.on('UPDATE.transactions.render', data => {\n      // add the new transaction\n    });\n    */\n\n  }\n\n\n};\n\n\n\n\n\n\n/*******************************************/\n\n// splash animation for the index page\nfunction playSplashPageAnimation (index) {\n  let words = ['ideas', 'adventure', 'inspiration', 'books', 'swap'];\n\n  // on transition end, start new transition. no need to add delay\n  let el = document.querySelector('.transition--' + words[index]);\n  el.classList.remove('is-invisible');\n  el.classList.remove('move-down-fade-in'); // the transition\n\n  if (!index) { // first element -- ideas\n    el.classList.add('move-down-fade-out');\n    playSplashPageAnimation(index + 1); // start immediately to align w/ other transitions\n  }\n\n  if (index === words.length - 1) { // last element -- swap\n    el.classList.add('translate--post');\n    document.querySelector('.banner__title--pre').classList.add('translate--pre');\n    setTimeout(() => { document.querySelector('.transition--books').lastChild.classList.add('is-invisible') }, 10); // timeout solution for the problem of the invisible 'Book' being removed after 'Books' invisibility is processed...\n  }\n\n  el.addEventListener('transitionend', function handleEvent(e) {\n    if (el.classList.contains('move-down-fade-out')) {\n      playSplashPageAnimation(index + 1);\n      el.removeEventListener('transitionend', handleEvent);\n    }\n\n    // check if it's the right transition that finished\n    else if (e.propertyName === 'opacity') {\n      if (index < words.length - 2) {\n        el.classList.add('move-down-fade-out');\n      }\n      else if (words[index] === 'books') { // basically if it gets here, it's 1 before the last\n        playSplashPageAnimation(index + 1);\n        el.removeEventListener('transitionend', handleEvent);\n      }\n    }\n  });\n}\n\n\n/***************************************************/\n\n\n// populate preview after a book search - what if not 'search to add'\nfunction displayPreview (data, source) {\n  let bookObject = {};\n\n  let requestSection;\n  let currentStep = null;\n\n\n  // event listener function\n  function createBook () {\n    socket.emit('CREATE.book', bookObject);\n    // cleanup - otherwise it will keep adding the first book\n //   document.querySelector('.preview__submit').removeEventListener('click', createBook);\n    document.querySelector('.preview__submit').classList.add('is-not-displayed');\n  }\n\n  if (source === 'external-query') { // google api\n\n    // remove any lingering click event listeners from multiple external searches\n\n    let json = data;\n\n    // problem is what happens when some fields are not available, such as thumbnail?\n    // check each to prevent error message (currently only using for thumbnail)\n    \n    bookObject.title = json.items[0].volumeInfo.title;\n    bookObject.author = json.items[0].volumeInfo.authors;\n    bookObject.description = json.items[0].volumeInfo.description;\n\n    bookObject.thumbnail = checkProperty(json.items[0], 'volumeInfo.imageLinks.thumbnail');\n\n    //bookObject.thumbnail = json.items[0].volumeInfo.imageLinks.thumbnail;\n    bookObject.link = json.items[0].volumeInfo.canonicalVolumeLink;\n    json.items[0].volumeInfo.industryIdentifiers.forEach(id => {\n      if (id.type === 'ISBN_10')\n        bookObject.ISBN_10 = id.identifier;\n      else if (id.type === 'ISBN_13')\n        bookObject.ISBN_13 = id.identifier;\n    });\n\n    document.querySelector('.preview__submit').classList.remove('is-not-displayed');\n\n    document.querySelector('.preview__submit').onclick = createBook;\n  }\n  else {\n    // assign to bookObject so that displaying the preview works regardless of source of query\n    bookObject.title = data.title;\n    bookObject.author = data.author;\n    bookObject.description = data.description;\n    bookObject.link = data.link;\n\n    if (source === 'internal-query') { // db search for book (non-request path)\n      // remove the add button - internal source means the display preview is generated from a\n      // click of one of the book images\n      if (document.querySelector('.preview__submit')) {\n       // document.querySelector('.preview__submit').removeEventListener('click', createBook);\n        // hide the icon as well.\n        document.querySelector('.preview__submit').classList.add('is-not-displayed');\n      }\n    }\n    else if (source === 'internal-request') { // request section\n      if (document.querySelector('.request__section--one .request__step-number').classList.contains('request__step-number--incomplete')) {\n        requestSection = document.querySelector('.request__section--one');\n        currentStep = 'one';\n      }\n      else if (document.querySelector('.request__section--two .request__step-number').classList.contains('request__step-number--incomplete')) {\n        requestSection = document.querySelector('.request__section--two');\n        currentStep = 'two';\n      }\n      else {\n        console.log('This should never happen...');\n      }\n\n      requestSection.querySelector('.preview__submit').addEventListener('click', e => {\n        // select for request\n        // have it show up in the request selection\n        requestSection.querySelector('.selection--title').textContent = data.title;\n        requestSection.querySelector('.selection--author').textContent = parseAuthorArray(data.author);\n        requestSection.querySelector('.request__selection__book-image .book__image').src = data.thumbnail;\n\n\n        \n       // requestSection.querySelector('.wrapper--request__selection').setAttribute('data-id', data._id);\n\n\n        requestSection.querySelector('.wrapper--request__selection').classList.remove('is-not-displayed');\n\n        requestSection.querySelector('.request__step-number').classList.remove('request__step-number--incomplete');\n        requestSection.querySelector('.request__step-number').classList.add('request__step-number--complete');\n\n        \n        if (currentStep === 'one') {\n          // bring up step two\n          requestSection.querySelector('.Request').classList.add('is-not-displayed');\n          document.querySelector('.form--swap').elements['requestId'].value = data._id;\n          document.querySelector('.request__section--two').classList.remove('is-not-displayed');\n          //saveBookToSwap(data, 'request'); // should only get the book id\n        }\n        else if (currentStep === 'two') {\n          // birng up step three\n          requestSection.querySelector('.Offer').classList.add('is-not-displayed');\n          document.querySelector('.form--swap').elements['offerId'].value = data._id;\n          document.querySelector('.request__section--three').classList.remove('is-not-displayed');\n\n          // confirm swap\n          /*\n          document.querySelector('.request__button--swap').addEventListener('click', e => {\n            // gather together the hidden input\n            let requestId = document.querySelector('form').elements['requestId'].value;\n            let offerId = document.querySelector('form').elements['offerId'].value;\n            \n\n            socket.emit('CREATE.transaction', { rId: requestId, oId: offerId });\n          });\n          */\n          \n          // take out cancel - MVP\n          /*\n          document.querySelector('.request__button--cancel').addEventListener('click', e => {\n            // start over\n            \n          });\n          */\n        }\n      });\n    }\n  }\n  \n  // if not on request page, then set variable such that the below code performs for all conditions\n  if (!requestSection)\n    requestSection = document;\n\n  requestSection.querySelector('.preview__title').textContent = bookObject.title;\n  requestSection.querySelector('.preview__link').href = bookObject.link;\n  requestSection.querySelector('.preview__close').addEventListener('click', () => {\n    requestSection.querySelector('.wrapper--preview').classList.add('is-not-displayed');\n  }); \n\n  requestSection.querySelector('.preview__author').textContent = parseAuthorArray(bookObject.author);\n\n  requestSection.querySelector('.preview__description').textContent = bookObject.description;\n\n  // display the preview\n  requestSection.querySelector('.wrapper--preview').classList.remove('is-not-displayed');\n}\n\n/***************************************************/\n\n\n// add/display book to bookshelf/bookshelves\nfunction displayBook (book, queryEvent, requestSection) {\n  let fragment = new DocumentFragment();\n  // mvp - img and data.id\n  \n  // book image\n  let newImg = document.createElement('img');\n  newImg.classList.add('book__image');\n  newImg.src = book.thumbnail;\n\n\n  // book container\n  let newDiv = document.createElement('div');\n  newDiv.classList.add('book');\n  //newDiv.classList.add('data-id=' + book._id);\n  newDiv.setAttribute('data-id', book._id);\n  newDiv.appendChild(newImg);  // book image\n\n  // svg lock container\n  if (book.transactionLock) {\n    let newImg2 = document.createElement('img');\n    newImg2.classList.add('book__lock');\n    newImg2.src = '/static/img/lock.svg';\n    newDiv.appendChild(newImg2); // svg lock\n  }\n\n\n\n  // on click shows the preview for the book\n  newDiv.addEventListener('click', e => {\n    socket.emit('READ.book', { bookId: book._id });\n    \n  });\n\n  fragment.appendChild(newDiv);\n  if (queryEvent) {\n    if (requestSection)\n      prependChild(requestSection.querySelector('.bookshelf--query'), fragment);\n    else prependChild(document.querySelector('.bookshelf--query'), fragment);\n  }\n  else {\n    if (requestSection)\n      prependChild(requestSection.querySelector('.bookshelf--complete'), fragment);\n    else prependChild(document.querySelector('.bookshelf--complete'), fragment);\n  }\n\n}\n\n/***************************************************/\n\n\n// shows the query results\nfunction renderQuery (data, requestStep) {\n// hide the 'all' results\n  document.querySelector('.bookshelf--complete').classList.add('is-not-displayed');\n\n  let requestSection, bookshelfQuery, bookshelfComplete, wrapperQuery;\n\n  if (requestStep === 'step-one') {\n    requestSection = document.querySelector('.request__section--one');\n   }\n  else if (requestStep === 'step-two') {\n    requestSection = document.querySelector('.request__section--two');\n  }\n  else requestSection = document;\n\n  bookshelfQuery = requestSection.querySelector('.bookshelf--query');\n  bookshelfComplete = requestSection.querySelector('.bookshelf--complete');\n  wrapperQuery = requestSection.querySelector('.wrapper--query');\n\n  // clear out old query results from element\n  while (bookshelfQuery.hasChildNodes()) {\n    bookshelfQuery.removeChild(bookshelfQuery.lastChild);\n  }\n\n  \n\n  requestSection.querySelector('.query__description__query-string').textContent = data.query;\n  requestSection.querySelector('.query__close').addEventListener('click', () => {\n    bookshelfComplete.classList.remove('is-not-displayed');\n    wrapperQuery.classList.add('is-not-displayed');\n    bookshelfQuery.classList.add('is-not-displayed');\n  });\n  bookshelfComplete.classList.add('is-not-displayed');\n  wrapperQuery.classList.remove('is-not-displayed');\n  bookshelfQuery.classList.remove('is-not-displayed');\n\n\n  if (data.books.length) { // if there exists results\n    for (let i = 0; i < data.books.length; i++) {\n      displayBook(data.books[i], true, requestSection);\n    }\n  }\n  else {\n    let newDiv = document.createElement('div');\n    newDiv.textContent = 'No results match the query.';\n    newDiv.classList.add('no-result');\n    \n    requestSection.querySelector('.bookshelf--query').appendChild(newDiv);\n  }\n}\n\n/***************************************************/\n\n// parses out the array to a string to display properly in various places\nfunction parseAuthorArray (authorsArray) {\n\n  let arrClone;\n\n  // dont mutate original array\n  if (Array.isArray(authorsArray)) {\n    arrClone = Array.prototype.slice.call(authorsArray); // in case not an array;\n  }\n  else return authorsArray;\n\n  let authorsLength = arrClone.length;\n  if (authorsLength > 2) {\n    arrClone[arrClone.length - 1] = 'and ' + arrClone[arrClone.length - 1];\n    return arrClone.join(', ');\n  }\n  else if (authorsLength > 1) {\n    return arrClone.join(' and ');\n  }\n  else return arrClone[0];\n}\n\n/**************************************************/\n\n\n// recursively check object property existence before querying it (specifically used in looking up thumbnail currently)\nfunction checkProperty (object, pathToKey) {\n  let keyDepth = pathToKey.split('.').length;\n  let currentKey = pathToKey.split('.')[0];\n  // let restOfKey = ;\n  \n  if (object.hasOwnProperty(currentKey)) {\n    if (keyDepth > 1) {\n      return checkProperty(object[currentKey], pathToKey.split('.').slice(1).join('.'));\n    }\n    else return object[pathToKey];\n  }\n  else return 'http://placehold.it/128x200';\n}\n\n/***********************************************/\n\n// prepend function\nfunction prependChild (parent, newFirstChild) {\n  parent.insertBefore(newFirstChild, parent.firstChild);\n}\n\n\n/***********************************************/\n\n\nfunction populateTransactions (data, path) {\n\n  let booksIWantFragment = new DocumentFragment(); // append to self-desired\n  let booksOthersWantFragment = new DocumentFragment(); // apend to other-desired\n\n  for (let i = 0; i < data.requestTransactions.length; i++) {\n    booksIWantFragment.insertBefore(displayTransaction(data.requestTransactions[i], 'request', path), booksIWantFragment.firstChild);\n  }\n  for (let i = 0; i < data.offerTransactions.length; i++) {\n    booksOthersWantFragment.insertBefore(displayTransaction(data.offerTransactions[i], 'offer', path), booksOthersWantFragment.firstChild);\n  }\n\n  document.querySelector('.self-desired').appendChild(booksIWantFragment);\n  document.querySelector('.other-desired').appendChild(booksOthersWantFragment);\n\n}\n\n\n/***********************************************/\n\nfunction displayTransaction (transaction, transactionType, path) {\n\n  let newTradeDiv = createTradeDiv();  \n\n  //newTradeDiv.querySelector('.trade').setAttribute('data-id', transaction._id);\n\n  if (transactionType === 'request') {\n    newTradeDiv.querySelector('.book--self-owned').firstChild.src = transaction.oBook.thumbnail;\n    newTradeDiv.querySelector('.book--other-owned').firstChild.src = transaction.rBook.thumbnail;\n  }\n  else if (transactionType === 'offer') {\n    newTradeDiv.querySelector('.book--self-owned').firstChild.src = transaction.rBook.thumbnail;\n    newTradeDiv.querySelector('.book--other-owned').firstChild.src = transaction.oBook.thumbnail;\n  }\n\n  if (path === 'pending') {\n    if (transactionType === 'request') {\n      // set description\n      newTradeDiv.querySelector('.trade__description').textContent = `You have requested to trade your copy of ${transaction.oBook.title} for another user's copy of ${transaction.rBook.title}.`;\n      // set arrow \n      newTradeDiv.querySelector('.arrow').firstChild.classList.add('arrow-right');\n      newTradeDiv.querySelector('.arrow').firstChild.src = '/static/img/arrow-right-pending.svg';\n    }\n    else if (transactionType === 'offer') {\n      newTradeDiv.querySelector('.trade__description').textContent = `Another user has requested to trade their copy of ${transaction.oBook.title} for your copy of ${transaction.rBook.title}.`;\n      newTradeDiv.querySelector('.arrow').firstChild.classList.add('arrow-left');\n      newTradeDiv.querySelector('.arrow').firstChild.src = '/static/img/arrow-left-pending.svg';\n      let tradeBtns = document.createElement('div');\n      tradeBtns.classList.add('trade__buttons');\n      let tradeBtnApprove = document.createElement('button');\n      tradeBtnApprove.classList.add('trade__button');\n      tradeBtnApprove.classList.add('trade__button--approve');\n      tradeBtnApprove.textContent = 'Approve';\n      let tradeBtnDecline = document.createElement('button');\n      tradeBtnDecline.classList.add('trade__button');\n      tradeBtnDecline.classList.add('trade__button--decline');\n      tradeBtnDecline.textContent = 'Decline';\n      tradeBtns.appendChild(tradeBtnApprove);\n      tradeBtns.appendChild(tradeBtnDecline);\n      newTradeDiv.querySelector('.trade').appendChild(tradeBtns);\n      // need to set up these approve/decine buttons\n      tradeBtnApprove.addEventListener('click', () => {\n        // retrieve the transaction number and book ids\n        // remove entire entry and move it to the complete section\n        //let transaction\n        socket.emit('DELETE.transaction', { _id: transaction._id, option: 'approve' });\n\n        // 'UPDATE.books.render' - since DELETE.transaction needs to validate before updating\n        //socket.emit('UPDATE.books', { // add the completed transaction to the books; remove locks\n        tradeBtnApprove.parentNode.parentNode.parentNode.removeChild(tradeBtnApprove.parentNode.parentNode);\n      });\n      tradeBtnDecline.addEventListener('click', () => {\n        socket.emit('DELETE.transaction', { _id: transaction._id, option: 'decline' });\n        //socket.emit('UPDATE.books', { // remove locks\n        tradeBtnDecline.parentNode.parentNode.parentNode.removeChild(tradeBtnDecline.parentNode.parentNode);\n      });\n    }\n  }\n  else if (path === 'completed') {\n    if (transactionType === 'request') {\n      newTradeDiv.querySelector('.trade__description').textContent = `You have traded your copy of ${transaction.oBook.title} for another user's copy of ${transaction.rBook.title}.`;\n      newTradeDiv.querySelector('.arrow').firstChild.classList.add('arrow-right');\n      newTradeDiv.querySelector('.arrow').firstChild.src = '/static/img/arrow-right-completed.svg';\n    }\n    else if (transactionType === 'offer') {\n      newTradeDiv.querySelector('.trade__description').textContent = `Another user has traded their copy of ${transaction.oBook.title} for your copy of ${transaction.rBook.title}.`;\n      newTradeDiv.querySelector('.arrow').firstChild.classList.add('arrow-left');\n      newTradeDiv.querySelector('.arrow').firstChild.src = '/static/img/arrow-left-completed.svg';\n    }\n  }\n\n  return newTradeDiv;\n}\n\n\nfunction createTradeDiv () {\n\n  let fragment = new DocumentFragment();\n\n  let tradeDiv = document.createElement('div');\n  tradeDiv.classList.add('trade');\n  fragment.appendChild(tradeDiv);\n\n  let descDiv = document.createElement('div');\n  descDiv.classList.add('trade__description');\n  tradeDiv.appendChild(descDiv);\n\n  let pictoDiv = document.createElement('div');\n  pictoDiv.classList.add('trade__pictogram');\n  tradeDiv.appendChild(pictoDiv);\n\n  let bookSelfOwnedDiv = document.createElement('div');\n  bookSelfOwnedDiv.classList.add('book--self-owned');\n  pictoDiv.appendChild(bookSelfOwnedDiv);\n\n  let bookSelfOwnedImg = document.createElement('img');\n  bookSelfOwnedImg.classList.add('book__image');\n  bookSelfOwnedDiv.appendChild(bookSelfOwnedImg);\n\n  let arrowDiv = document.createElement('div');\n  arrowDiv.classList.add('arrow');\n  pictoDiv.appendChild(arrowDiv);\n\n  let arrowImg = document.createElement('img');\n  arrowDiv.appendChild(arrowImg);\n\n  let bookOtherOwnedDiv = document.createElement('div');\n  bookOtherOwnedDiv.classList.add('book--other-owned');\n  pictoDiv.appendChild(bookOtherOwnedDiv);\n\n  let bookOtherOwnedImg = document.createElement('img');\n  bookOtherOwnedImg.classList.add('book__image');\n  bookOtherOwnedDiv.appendChild(bookOtherOwnedImg);\n\n  return fragment;\n  \n\n}\n"]}