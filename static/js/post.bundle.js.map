{"version":3,"sources":["../../../node_modules/browser-pack/_prelude.js","post.js"],"names":["e","t","n","r","s","o","u","a","require","i","f","Error","code","l","exports","call","length","1","module","loadImages","data","console","log","createBrick","datum","newBrick","document","querySelector","cloneNode","counter","heartFill","firstChild","setAttribute","_id","src","link","title","alt","textContent","linkerProfileImage","linkerScreenName","hearts","addEventListener","fetch","method","credentials","headers","Content-Type","body","JSON","stringify","id","then","res","json","classList","toggle","catch","err","error","Access-Control-Allow-Methods","message","parentNode","removeChild","insertBefore","remove","window","onload","location","pathname","match"],"mappings":"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","file":"post.bundle.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","'use strict';\n\nwindow.onload = function () {\n  if (!location.pathname.match(/^\\/addbrick\\/?$/i)) {\n    fetch('/api/bricks', { credentials: 'same-origin' })\n      .then(res => res.json())\n      .then(json => loadImages(json))\n      .catch(err => console.error(err));\n  }\n};\n\n// load images from json\nfunction loadImages (data) {\n  console.log(data);\n  for (let i = 0; i < data.length; i++) {\n    createBrick(data[i]);\n  }\n}\n\nfunction createBrick (datum) {\n  const newBrick = document.querySelector('.masonry-element').cloneNode(true);\n  console.log(newBrick);\n\n  const counter = newBrick.querySelector('.brick__counter');\n  const heartFill = newBrick.querySelector('.brick__heart--fill');\n\n  newBrick.firstChild.setAttribute('data-id', datum._id);\n  newBrick.querySelector('.brick__image').src = datum.link;\n  newBrick.querySelector('.brick__image').title = datum.title;\n  newBrick.querySelector('.brick__image').alt = datum.title;\n  newBrick.querySelector('.brick__title').textContent = datum.title;\n  newBrick.querySelector('.brick__user').src = datum.linkerProfileImage;\n  newBrick.querySelector('.brick__user').title = '@' + datum.linkerScreenName;\n  newBrick.querySelector('.brick__user').alt = '@' + datum.linkerScreenName;\n  counter.textContent = datum.hearts;\n\n  // send: the id of the brick, the user can be inferred from the req itself.\n  newBrick.querySelector('.brick__favorite').addEventListener('click', () => {\n    fetch('/api/bricks', { method: 'POST', credentials: 'same-origin' , headers: { 'Content-Type': 'application/json' }, body: JSON.stringify({ id: datum._id }) })\n      .then(res => res.json())\n      .then(json => {\n        counter.textContent = json.hearts;\n        heartFill.classList.toggle('is-hearted');\n      })\n      .catch(err => console.error(err));\n  });\n\n\n  if (newBrick.querySelector('.brick__close')) { // or check if path is mybricks\n    newBrick.querySelector('.brick__close').addEventListener('click', () => {\n      fetch('/api/bricks', { method: 'DELETE', credentials: 'same-origin', headers: { 'Content-Type': 'application/json', 'Access-Control-Allow-Methods': 'POST, GET, DELETE' }, body: JSON.stringify({ id: datum._id }) })\n        .then(res => res.json())\n        .then(json => {\n          // remove the entire element from the displayi\n          if (json.message === 'success') {\n            newBrick.parentNode.removeChild(newBrick);\n          }\n        })\n        .catch(err => console.error(err));\n    });\n  }\n\n  document.querySelector('.wrapper--bricks').insertBefore(newBrick, document.querySelector('.masonry-element-sizer'));\n  newBrick.classList.remove('is-not-displayed');\n}\n\n"]}