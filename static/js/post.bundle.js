!function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a="function"==typeof require&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n||e)},l,l.exports,e,t,n,r)}return n[o].exports}for(var i="function"==typeof require&&require,o=0;o<r.length;o++)s(r[o]);return s}({1:[function(require,module,exports){"use strict";function loadImages(data){for(var esques=new DocumentFragment,i=0;i<data.length;i++)createEsque(data[i],esques);var allImages=esques.querySelectorAll(".esque__image, .esque__user");imagesLoaded(allImages,function(){var container=document.querySelector(".wrapper--esquewall");container.appendChild(esques);new Masonry(container,{itemSelector:".masonry-element",columnWidth:".masonry-element-sizer",percentPosition:!0})})}function createEsque(datum,fragment){var newEsque=document.querySelector(".masonry-element").cloneNode(!0),counter=newEsque.querySelector(".esque__counter"),heartFill=newEsque.querySelector(".esque__heart--fill"),image=newEsque.querySelector(".esque__image"),user=newEsque.querySelector(".esque__user");newEsque.firstChild.setAttribute("data-id",datum._id),image.src=datum.link,image.title=datum.title,image.alt=datum.title,newEsque.querySelector(".esque__title").textContent=datum.title,user.src=datum.linkerProfileImage,user.title="@"+datum.linkerScreenName,user.alt="@"+datum.linkerScreenName,counter.textContent=datum.hearts,datum.userHearted&&heartFill.classList.add("is-hearted"),user.addEventListener("click",function(){location.href=location.protocol+"//"+location.host+"/user/"+datum.linkerScreenName}),newEsque.querySelector(".esque__favorite").addEventListener("click",function(){fetch("/api/esques",{method:"POST",credentials:"same-origin",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:datum._id})}).then(function(res){return res.json()}).then(function(json){counter.textContent=json.hearts,heartFill.classList.toggle("is-hearted")}).catch(function(err){return console.error(err)})}),newEsque.querySelector(".esque__close")&&(newEsque.querySelector(".esque").addEventListener("mouseover",function(){newEsque.querySelector(".esque__close").classList.add("is-displayed")}),newEsque.querySelector(".esque").addEventListener("mouseout",function(){newEsque.querySelector(".esque__close").classList.remove("is-displayed")}),newEsque.querySelector(".esque__close").addEventListener("click",function(){fetch("/api/esques",{method:"DELETE",credentials:"same-origin",headers:{"Content-Type":"application/json","Access-Control-Allow-Methods":"POST, GET, DELETE"},body:JSON.stringify({id:datum._id})}).then(function(res){return res.json()}).then(function(json){"success"===json.message&&newEsque.parentNode.removeChild(newEsque)}).catch(function(err){return console.error(err)})})),fragment.appendChild(newEsque),newEsque.classList.remove("is-not-displayed")}window.onload=function(){location.pathname.match(/^\/addesque\/?$/i)||fetch("/api/esques",{credentials:"same-origin"}).then(function(res){return res.json()}).then(function(json){return loadImages(json)}).catch(function(err){return console.error(err)})}},{}]},{},[1]);
//# sourceMappingURL=post.bundle.js.map
